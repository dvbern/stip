<div class="container mt-5 mb-5">
  <div
    class="d-flex align-items-center justify-content-between border-bottom border-3 mb-4"
  >
    <dv-shared-ui-progress-bar [current]="4" [total]="12" />
    <div class="text-end">
      <h2>{{ 'gesuch-app.familiensituation.title' | translate }}</h2>
      <p class="fs-5 fst-italic">
        {{ 'gesuch-app.form.next' | translate }}:
        {{ 'gesuch-app.form.education.title' | translate }}
      </p>
    </div>
  </div>

  <div>
    <div
      data-test-id="form-person-loading"
      *ngIf="view().loading"
      class="my-2 p-2 py-4 d-flex rounded shadow-sm border"
    >
      <div class="dv-progress-bar-indeterminate">
        <div></div>
      </div>
    </div>

    <form
      [formGroup]="form"
      novalidate
      class="mt-4"
      *ngIf="!view().loading"
      (ngSubmit)="handleSaveAndContinue()"
    >
      <div class="row g-4 mt-3">
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.leibliche-eltern-verheiratet-konkubinat.label'
              | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="leiblicheElternVerheiratetKonkubinat"
              [value]="true"
              class="form-check-input"
              type="radio"
              name="leiblicheElternVerheiratetKonkubinat"
              id="leiblicheElternVerheiratetKonkubinatJa"
            />
            <label
              class="form-check-label"
              for="leiblicheElternVerheiratetKonkubinatJa"
            >
              {{ 'shared.form.radio.yes' | translate }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="leiblicheElternVerheiratetKonkubinat"
              [value]="false"
              class="form-check-input"
              type="radio"
              name="leiblicheElternVerheiratetKonkubinat"
              id="leiblicheElternVerheiratetKonkubinatNein"
            />
            <label
              class="form-check-label"
              for="leiblicheElternVerheiratetKonkubinatNein"
            >
              {{ 'shared.form.radio.no' | translate }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.gerichtlicheAlimentenregelung.disabled"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.gerichtliche-alimentenregelung.label'
              | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="gerichtlicheAlimentenregelung"
              [value]="true"
              class="form-check-input"
              type="radio"
              name="gerichtlicheAlimentenregelung"
              id="gerichtlicheAlimentenregelungJa"
            />
            <label
              class="form-check-label"
              for="gerichtlicheAlimentenregelungJa"
            >
              {{ 'shared.form.radio.yes' | translate }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="gerichtlicheAlimentenregelung"
              [value]="false"
              class="form-check-input"
              type="radio"
              name="gerichtlicheAlimentenregelung"
              id="gerichtlicheAlimentenregelungNein"
            />
            <label
              class="form-check-label"
              for="gerichtlicheAlimentenregelungNein"
            >
              {{ 'shared.form.radio.no' | translate }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.elternteilVerstorbenUnbekannt.disabled"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.label'
              | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="elternteilVerstorbenUnbekannt"
              [value]="true"
              class="form-check-input"
              type="radio"
              name="elternteilVerstorbenUnbekannt"
              id="elternteilVerstorbenUnbekanntJa"
            />
            <label
              class="form-check-label"
              for="elternteilVerstorbenUnbekanntJa"
            >
              {{ 'shared.form.radio.yes' | translate }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="elternteilVerstorbenUnbekannt"
              [value]="false"
              class="form-check-input"
              type="radio"
              name="elternteilVerstorbenUnbekannt"
              id="elternteilVerstorbenUnbekanntNein"
            />
            <label
              class="form-check-label"
              for="elternteilVerstorbenUnbekanntNein"
            >
              {{ 'shared.form.radio.no' | translate }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.werZahltAlimente.disabled"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.wer-zahlt-alimente.label'
              | translate
          }}</dv-shared-ui-form-label>
          <select
            class="form-select"
            dvSharedUiFormLabelTarget
            formControlName="werZahltAlimente"
          >
            <option [value]="null" disabled selected>
              {{ 'shared.form.select.empty' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.VATER">
              {{ 'gesuch-app.form.familiensituation.vater' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.MUTTER">
              {{ 'gesuch-app.form.familiensituation.mutter' | translate }}
            </option>
          </select>
          <dv-shared-ui-form-message *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </dv-shared-ui-form-message>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.mutterUnbekanntVerstorben.disabled"
      >
        <span>{{
          'gesuch-app.form.familiensituation.elternteil-verstorben.label'
            | translate
        }}</span>
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.mutter' | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="mutterUnbekanntVerstorben"
              [value]="ELTERN_ABWESENHEITS_GRUND.VERSTORBEN"
              class="form-check-input"
              type="radio"
              id="mutterTot"
            />
            <label class="form-check-label" for="mutterTot">
              {{
                'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.verstorben'
                  | translate
              }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="mutterUnbekanntVerstorben"
              [value]="ELTERN_ABWESENHEITS_GRUND.UNBEKANNT"
              class="form-check-input"
              type="radio"
              id="mutterUnbekannt"
            />
            <label class="form-check-label" for="mutterUnbekannt">
              {{
                'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.unbekannt'
                  | translate
              }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="mutterUnbekanntVerstorben"
              [value]="ELTERN_ABWESENHEITS_GRUND.WEDER_NOCH"
              class="form-check-input"
              type="radio"
              id="mutterUnbekanntVerstorbenNone"
            />
            <label class="form-check-label" for="mutterUnbekanntVerstorbenNone">
              {{
                'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.keine'
                  | translate
              }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.mutterUnbekanntReason.disabled"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.mutter-unbekannt-reason.label'
              | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="mutterUnbekanntReason"
              [value]="ELTERN_UNBEKANNTHEITS_GRUND.UNBEKANNTER_AUFENTHALTSORT"
              class="form-check-input"
              type="radio"
              id="mutterUnbekanntReasonAufenthaltsort"
            />
            <label
              class="form-check-label"
              for="mutterUnbekanntReasonAufenthaltsort"
            >
              {{
                'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.unbekannter-aufenthaltsort'
                  | translate
              }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="mutterUnbekanntReason"
              [value]="ELTERN_UNBEKANNTHEITS_GRUND.FEHLENDE_ANERKENNUNG"
              class="form-check-input"
              type="radio"
              id="mutterUnbekanntReasonmutterschaftsanerkennung"
            />
            <label
              class="form-check-label"
              for="mutterUnbekanntReasonmutterschaftsanerkennung"
            >
              {{
                'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.fehlende-mutterschaftsanerkennung'
                  | translate
              }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.mutterWiederverheiratet.disabled"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.mutter-wiederverheiratet.label'
              | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="mutterWiederverheiratet"
              [value]="true"
              class="form-check-input"
              type="radio"
              name="mutterWiederverheiratet"
              id="mutterWiederverheiratetJa"
            />
            <label class="form-check-label" for="mutterWiederverheiratetJa">
              {{ 'shared.form.radio.yes' | translate }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="mutterWiederverheiratet"
              [value]="false"
              class="form-check-input"
              type="radio"
              name="mutterWiederverheiratet"
              id="mutterWiederverheiratetNein"
            />
            <label class="form-check-label" for="mutterWiederverheiratetNein">
              {{ 'shared.form.radio.no' | translate }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.vaterUnbekanntVerstorben.disabled"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.vater' | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="vaterUnbekanntVerstorben"
              [value]="ELTERN_ABWESENHEITS_GRUND.VERSTORBEN"
              class="form-check-input"
              type="radio"
              id="vaterTot"
            />
            <label class="form-check-label" for="vaterTot">
              {{
                'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.verstorben'
                  | translate
              }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="vaterUnbekanntVerstorben"
              [value]="ELTERN_ABWESENHEITS_GRUND.UNBEKANNT"
              class="form-check-input"
              type="radio"
              id="vaterUnbekannt"
            />
            <label class="form-check-label" for="vaterUnbekannt">
              {{
                'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.unbekannt'
                  | translate
              }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="vaterUnbekanntVerstorben"
              [value]="ELTERN_ABWESENHEITS_GRUND.WEDER_NOCH"
              class="form-check-input"
              type="radio"
              id="vaterUnbekanntVerstorbenNone"
            />
            <label class="form-check-label" for="vaterUnbekanntVerstorbenNone">
              {{
                'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.keine'
                  | translate
              }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        class="row g-4 mt-3"
        *ngIf="!form.controls.vaterWiederverheiratet.disabled"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.vater-wiederverheiratet.label'
              | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="vaterWiederverheiratet"
              [value]="true"
              class="form-check-input"
              type="radio"
              name="vaterWiederverheiratet"
              id="vaterWiederverheiratetJa"
            />
            <label class="form-check-label" for="vaterWiederverheiratetJa">
              {{ 'shared.form.radio.yes' | translate }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="vaterWiederverheiratet"
              [value]="false"
              class="form-check-input"
              type="radio"
              name="vaterWiederverheiratet"
              id="vaterWiederverheiratetNein"
            />
            <label class="form-check-label" for="vaterWiederverheiratetNein">
              {{ 'shared.form.radio.no' | translate }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div
        *ngIf="!form.controls.vaterUnbekanntReason.disabled"
        class="row g-4 mt-3"
      >
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.vater-unbekannt-reason.label'
              | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              formControlName="vaterUnbekanntReason"
              [value]="ELTERN_UNBEKANNTHEITS_GRUND.UNBEKANNTER_AUFENTHALTSORT"
              class="form-check-input"
              type="radio"
              id="vaterUnbekanntReasonAufenthaltsort"
            />
            <label
              class="form-check-label"
              for="vaterUnbekanntReasonAufenthaltsort"
            >
              {{
                'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.unbekannter-aufenthaltsort'
                  | translate
              }}
            </label>
          </div>
          <div class="form-check">
            <input
              formControlName="vaterUnbekanntReason"
              [value]="ELTERN_UNBEKANNTHEITS_GRUND.FEHLENDE_ANERKENNUNG"
              class="form-check-input"
              type="radio"
              id="vaterUnbekanntReasonVaterschaftsanerkennung"
            />
            <label
              class="form-check-label"
              for="vaterUnbekanntReasonVaterschaftsanerkennung"
            >
              {{
                'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.fehlende-vaterschaftsanerkennung'
                  | translate
              }}
            </label>
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div class="row g-4 mt-3" *ngIf="!form.controls.sorgerecht.disabled">
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.sorgerecht.label' | translate
          }}</dv-shared-ui-form-label>
          <select
            class="form-select"
            dvSharedUiFormLabelTarget
            formControlName="sorgerecht"
          >
            <option [value]="null" disabled selected>
              {{ 'shared.form.select.empty' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.VATER">
              {{ 'gesuch-app.form.familiensituation.vater' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.MUTTER">
              {{ 'gesuch-app.form.familiensituation.mutter' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.GEMEINSAM">
              {{
                'gesuch-app.form.familiensituation.sorgerecht.gemeinsam'
                  | translate
              }}
            </option>
          </select>
          <dv-shared-ui-form-message *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </dv-shared-ui-form-message>
        </dv-shared-ui-form-field>
      </div>

      <div
        *ngIf="
          !form.controls.sorgerechtVater.disabled &&
          !form.controls.sorgerechtMutter.disabled
        "
        class="row g-4 mt-3"
      >
        <dv-shared-ui-form-field class="col-2 col-md-2 col-xl-2">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.mutter' | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              class="form-control"
              type="text"
              dvSharedUiFormLabelTarget
              formControlName="sorgerechtMutter"
            />
          </div>
        </dv-shared-ui-form-field>
        <div class="col-6 col-md-8 col-xl-8">
          <span>{{
            'gesuch-app.form.familiensituation.obhutsauteilung.label'
              | translate
          }}</span>
        </div>
        <dv-shared-ui-form-field class="col-2 col-md-2 col-xl-2">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.vater' | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              class="form-control"
              type="text"
              dvSharedUiFormLabelTarget
              formControlName="sorgerechtVater"
            />
          </div>
        </dv-shared-ui-form-field>
      </div>

      <div class="row g-4 mt-3" *ngIf="!form.controls.obhut.disabled">
        <dv-shared-ui-form-field class="col-12 col-md-6 col-xl-4">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.obhut.label' | translate
          }}</dv-shared-ui-form-label>
          <select
            class="form-select"
            dvSharedUiFormLabelTarget
            formControlName="obhut"
          >
            <option [value]="null" disabled selected>
              {{ 'shared.form.select.empty' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.VATER">
              {{ 'gesuch-app.form.familiensituation.vater' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.MUTTER">
              {{ 'gesuch-app.form.familiensituation.mutter' | translate }}
            </option>
            <option [value]="ELTERNSCHAFTSTEILUNG.GEMEINSAM">
              {{
                'gesuch-app.form.familiensituation.sorgerecht.gemeinsam'
                  | translate
              }}
            </option>
          </select>
          <dv-shared-ui-form-message *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </dv-shared-ui-form-message>
        </dv-shared-ui-form-field>
      </div>

      <div
        *ngIf="
          !form.controls.obhutVater.disabled &&
          !form.controls.obhutMutter.disabled
        "
        class="row g-4 mt-3"
      >
        <dv-shared-ui-form-field class="col-2 col-md-2 col-xl-2">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.mutter' | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              class="form-control"
              type="text"
              dvSharedUiFormLabelTarget
              formControlName="obhutMutter"
            />
          </div>
        </dv-shared-ui-form-field>
        <div class="col-6 col-md-8 col-xl-8">
          <span>{{
            'gesuch-app.form.familiensituation.obhutsauteilung.label'
              | translate
          }}</span>
        </div>
        <dv-shared-ui-form-field class="col-2 col-md-2 col-xl-2">
          <dv-shared-ui-form-label>{{
            'gesuch-app.form.familiensituation.vater' | translate
          }}</dv-shared-ui-form-label>
          <div class="form-check">
            <input
              class="form-control"
              type="text"
              dvSharedUiFormLabelTarget
              formControlName="obhutVater"
            />
          </div>
        </dv-shared-ui-form-field>
      </div>

      <!-- buttons -->
      <div
        class="mt-5 d-flex flex-column gap-3 flex-md-row justify-content-end"
      >
        <button type="submit" class="btn btn-primary">
          {{ 'gesuch-app.form.save-and-continue' | translate }}
        </button>
        <button
          type="button"
          class="btn btn-link"
          data-test-id="form-person-action-back"
          (click)="handleSaveAndBack()"
        >
          {{ 'gesuch-app.form.save-and-back' | translate }}
        </button>
      </div>
    </form>
  </div>
</div>
