<dv-gesuch-app-pattern-gesuch-step-layout [step]="GesuchFormSteps.PARTNER">
  <div>
    <!-- loading -->
    <div
      data-testid="form-partner-loading"
      *ngIf="view().loading"
      class="my-2 p-2 py-4 d-flex rounded shadow-sm border"
    >
      <div class="dv-progress-bar-indeterminate">
        <div></div>
      </div>
    </div>

    <form
      [formGroup]="form"
      novalidate
      class="mt-4"
      *ngIf="!view().loading"
      (ngSubmit)="handleSaveAndContinue()"
    >
      <h3 class="pt-5">
        {{ 'gesuch-app.form.shared.section.personal-details' | translate }}
      </h3>
      <!-- AHV -->
      <div class="row g-4 my-2">
        <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
          <mat-label>{{
            'gesuch-app.form.shared.social-insurance-number.label' | translate
          }}</mat-label>
          <input
            matInput
            type="text"
            formControlName="sozialversicherungsnummer"
            placeholder="756.xxxx.xxxx.xx"
            [maskito]="MASK_SOZIALVERSICHERUNGSNUMMER"
          />
          <mat-error *dvSharedUiFormMessageInfo>
            {{
              'gesuch-app.form.shared.social-insurance-number.info' | translate
            }}
          </mat-error>
          <mat-error *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </mat-error>
          <mat-error *dvSharedUiFormMessageError="'ahv'">
            {{ 'shared.form.error.ahv' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="row g-4 my-2">
        <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
          <mat-label>{{
            'gesuch-app.form.shared.lastname.label' | translate
          }}</mat-label>
          <input formControlName="nachname" matInput type="text" />
          <mat-error *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </mat-error>
        </mat-form-field>
        <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
          <mat-label>{{
            'gesuch-app.form.shared.firstname.label' | translate
          }}</mat-label>
          <input formControlName="vorname" matInput type="text" />
          <mat-error *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="row g-4 my-2">
        <!-- C/O-Adresse -->
        <mat-form-field
          class="col-12 col-md-6 col-xl-4"
          formGroupName="adresse"
        >
          <mat-label
            >{{ 'gesuch-app.form.shared.address.co.label' | translate }} ({{
              'shared.form.optional.label' | translate
            }})
          </mat-label>
          <input matInput type="text" formControlName="coAdresse" />
        </mat-form-field>
      </div>

      <div class="row g-4 my-2" formGroupName="adresse">
        <div class="col-12 col-md-6 col-xl-4">
          <div class="row gx-2">
            <!-- Strasse -->
            <mat-form-field dvSharedUiFormField class="col-8 col-xl-9">
              <mat-label
                >{{ 'gesuch-app.form.shared.address.street.label' | translate }}
              </mat-label>
              <input matInput type="text" formControlName="strasse" />
              <mat-error *dvSharedUiFormMessageError="'required'">
                {{ 'shared.form.error.required' | translate }}
              </mat-error>
            </mat-form-field>

            <!-- Nr -->
            <mat-form-field dvSharedUiFormField class="col-4 col-xl-3">
              <mat-label
                >{{ 'gesuch-app.form.shared.address.number.label' | translate }}
              </mat-label>
              <input matInput type="text" formControlName="hausnummer" />
              <mat-error *dvSharedUiFormMessageError="'required'">
                {{ 'shared.form.error.required' | translate }}
              </mat-error>
            </mat-form-field>
          </div>
        </div>

        <div class="col-12 col-md-6 col-xl-4">
          <div class="row gx-2">
            <!-- PLZ -->
            <mat-form-field dvSharedUiFormField class="col-5 col-md-4 col-xl-3">
              <mat-label
                >{{
                  'gesuch-app.form.shared.address.zipcode.label' | translate
                }}
              </mat-label>
              <input matInput type="text" formControlName="plz" />
              <mat-error *dvSharedUiFormMessageError="'required'">
                {{ 'shared.form.error.requiredShort' | translate }}
              </mat-error>
            </mat-form-field>

            <!-- Ort -->
            <mat-form-field dvSharedUiFormField class="col-7 col-md-8 col-xl-9">
              <mat-label
                >{{ 'gesuch-app.form.shared.address.city.label' | translate }}
              </mat-label>
              <input matInput type="text" formControlName="ort" />
              <mat-error *dvSharedUiFormMessageError="'required'">
                {{ 'shared.form.error.required' | translate }}
              </mat-error>
            </mat-form-field>
          </div>
        </div>
      </div>

      <div class="row g-4 my-2" formGroupName="adresse">
        <!-- Land -->
        <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
          <mat-label>{{
            'gesuch-app.form.shared.address.country.label' | translate
          }}</mat-label>
          <mat-select formControlName="land">
            <mat-option [value]="null" disabled selected>
              {{ 'shared.form.select.empty' | translate }}
            </mat-option>
            <mat-option
              [value]="l.code"
              *ngFor="
                let l of translatedLaender$ | async;
                trackBy: trackByIndex
              "
            >
              {{ l.text }}
            </mat-option>
          </mat-select>
          <mat-error *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="row g-4 my-2">
        <!-- GEBURTSDATUM -->
        <mat-form-field dvSharedUiFormField class="col-12 col-xl-4">
          <mat-label>{{
            'gesuch-app.form.shared.birthday.label' | translate
          }}</mat-label>

          <input
            matInput
            placeholder="dd.mm.yyyy"
            formControlName="geburtsdatum"
            (blur)="onGeburtsdatumBlur($event)"
          />

          <mat-error *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </mat-error>
          <mat-error *dvSharedUiFormMessageError="'dateFormat'">
            {{ 'shared.form.error.dateFormat' | translate }}
          </mat-error>
          <mat-error *dvSharedUiFormMessageError="'minDate'">
            {{ 'shared.form.error.minDatePast' | translate }}
          </mat-error>
          <mat-error *dvSharedUiFormMessageError="'maxDate'">
            {{ 'shared.form.error.maxDatePast' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="row g-4 my-2">
        <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
          <mat-label>{{
            'gesuch-app.form.partner.jahreseinkommen.label' | translate
          }}</mat-label>
          <input formControlName="jahreseinkommen" matInput type="text" />
          <mat-error *dvSharedUiFormMessageError="'required'">
            {{ 'shared.form.error.required' | translate }}
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Buttons -->
      <dv-gesuch-app-ui-step-form-buttons>
        <button type="submit" class="btn btn-primary">
          {{ 'gesuch-app.form.save-and-continue' | translate }}
        </button>
      </dv-gesuch-app-ui-step-form-buttons>
    </form>
  </div>
</dv-gesuch-app-pattern-gesuch-step-layout>
