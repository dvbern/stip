<div
  data-testid="form-person-loading"
  *ngIf="view().loading"
  class="my-2 p-2 py-4 d-flex rounded shadow-sm border"
>
  <div class="dv-progress-bar-indeterminate">
    <div></div>
  </div>
</div>
<form
  [formGroup]="form"
  novalidate
  class="mt-4"
  *ngIf="!view().loading"
  (ngSubmit)="handleSave()"
>
  <div class="row g-4 mt-3">
    <mat-radio-group
      formControlName="elternVerheiratetZusammen"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.leibliche-eltern-verheiratet-konkubinat.label'
          | translate
      }}</label>

      <mat-radio-button [value]="true">{{
        'shared.form.radio.yes' | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="false">{{
        'shared.form.radio.no' | translate
      }}</mat-radio-button>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div
    class="row g-4 mt-3"
    *ngIf="!form.controls.gerichtlicheAlimentenregelung.disabled"
  >
    <mat-radio-group
      formControlName="gerichtlicheAlimentenregelung"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.gerichtliche-alimentenregelung.label'
          | translate
      }}</label>
      <mat-radio-button [value]="true">{{
        'shared.form.radio.yes' | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="false">{{
        'shared.form.radio.no' | translate
      }}</mat-radio-button>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div
    class="row g-4 mt-3"
    *ngIf="!form.controls.elternteilUnbekanntVerstorben.disabled"
  >
    <mat-radio-group
      formControlName="elternteilUnbekanntVerstorben"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.label'
          | translate
      }}</label>
      <mat-radio-button [value]="true">{{
        'shared.form.radio.yes' | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="false">{{
        'shared.form.radio.no' | translate
      }}</mat-radio-button>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div class="row g-4 mt-3" *ngIf="!form.controls.werZahltAlimente.disabled">
    <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
      <mat-label>{{
        'gesuch-app.form.familiensituation.wer-zahlt-alimente.label' | translate
      }}</mat-label>
      <mat-select formControlName="werZahltAlimente">
        <mat-option [value]="null" disabled selected>
          {{ 'shared.form.select.empty' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.VATER">
          {{ 'gesuch-app.form.familiensituation.vater' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.MUTTER">
          {{ 'gesuch-app.form.familiensituation.mutter' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.GEMEINSAM">
          {{ 'gesuch-app.form.familiensituation.gemeinsam' | translate }}
        </mat-option>
      </mat-select>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-form-field>
  </div>

  <div
    class="row g-4 mt-3"
    *ngIf="!form.controls.mutterUnbekanntVerstorben.disabled"
  >
    <span>{{
      'gesuch-app.form.familiensituation.elternteil-verstorben.label'
        | translate
    }}</span>
    <mat-radio-group
      formControlName="mutterUnbekanntVerstorben"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.mutter' | translate
      }}</label>

      <mat-radio-button [value]="ELTERN_ABWESENHEITS_GRUND.VERSTORBEN">{{
        'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.verstorben'
          | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="ELTERN_ABWESENHEITS_GRUND.UNBEKANNT">{{
        'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.unbekannt'
          | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="ELTERN_ABWESENHEITS_GRUND.WEDER_NOCH">{{
        'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.keine'
          | translate
      }}</mat-radio-button>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div
    class="row g-4 mt-3"
    *ngIf="!form.controls.mutterUnbekanntGrund.disabled"
  >
    <mat-radio-group
      formControlName="mutterUnbekanntGrund"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.mutter-unbekannt-reason.label'
          | translate
      }}</label>

      <mat-radio-button
        [value]="ELTERN_UNBEKANNTHEITS_GRUND.UNBEKANNTER_AUFENTHALTSORT"
        >{{
          'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.unbekannter-aufenthaltsort'
            | translate
        }}</mat-radio-button
      >

      <mat-radio-button
        [value]="ELTERN_UNBEKANNTHEITS_GRUND.FEHLENDE_ANERKENNUNG"
        >{{
          'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.fehlende-mutterschaftsanerkennung'
            | translate
        }}</mat-radio-button
      >

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div
    class="row g-4 mt-3"
    *ngIf="!form.controls.mutterWiederverheiratet.disabled"
  >
    <mat-radio-group
      formControlName="mutterWiederverheiratet"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.mutter-wiederverheiratet.label'
          | translate
      }}</label>

      <mat-radio-button [value]="true">{{
        'shared.form.radio.yes' | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="false">{{
        'shared.form.radio.no' | translate
      }}</mat-radio-button>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div
    class="row g-4 mt-3"
    *ngIf="!form.controls.vaterUnbekanntVerstorben.disabled"
  >
    <mat-radio-group
      formControlName="vaterUnbekanntVerstorben"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{ 'gesuch-app.form.familiensituation.vater' | translate }}</label>

      <mat-radio-button [value]="ELTERN_ABWESENHEITS_GRUND.VERSTORBEN">{{
        'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.verstorben'
          | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="ELTERN_ABWESENHEITS_GRUND.UNBEKANNT">{{
        'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.unbekannt'
          | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="ELTERN_ABWESENHEITS_GRUND.WEDER_NOCH">{{
        'gesuch-app.form.familiensituation.elternteil-verstorben-unbekannt.keine'
          | translate
      }}</mat-radio-button>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div
    class="row g-4 mt-3"
    *ngIf="!form.controls.vaterWiederverheiratet.disabled"
  >
    <mat-radio-group
      formControlName="vaterWiederverheiratet"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.vater-wiederverheiratet.label'
          | translate
      }}</label>

      <mat-radio-button [value]="true">{{
        'shared.form.radio.yes' | translate
      }}</mat-radio-button>

      <mat-radio-button [value]="false">{{
        'shared.form.radio.no' | translate
      }}</mat-radio-button>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div *ngIf="!form.controls.vaterUnbekanntGrund.disabled" class="row g-4 mt-3">
    <mat-radio-group
      formControlName="vaterUnbekanntGrund"
      dvSharedUiFormField
      class="col-12 col-md-6 col-xl-4 d-flex flex-column"
    >
      <label>{{
        'gesuch-app.form.familiensituation.vater-unbekannt-reason.label'
          | translate
      }}</label>

      <mat-radio-button
        [value]="ELTERN_UNBEKANNTHEITS_GRUND.UNBEKANNTER_AUFENTHALTSORT"
        >{{
          'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.unbekannter-aufenthaltsort'
            | translate
        }}</mat-radio-button
      >

      <mat-radio-button
        [value]="ELTERN_UNBEKANNTHEITS_GRUND.FEHLENDE_ANERKENNUNG"
        >{{
          'gesuch-app.form.familiensituation.elternteil-unbekannt-reason.fehlende-vaterschaftsanerkennung'
            | translate
        }}</mat-radio-button
      >

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-radio-group>
  </div>

  <div class="row g-4 mt-3" *ngIf="!form.controls.sorgerecht.disabled">
    <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
      <mat-label>{{
        'gesuch-app.form.familiensituation.sorgerecht.label' | translate
      }}</mat-label>
      <mat-select formControlName="sorgerecht">
        <mat-option [value]="null" disabled selected>
          {{ 'shared.form.select.empty' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.VATER">
          {{ 'gesuch-app.form.familiensituation.vater' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.MUTTER">
          {{ 'gesuch-app.form.familiensituation.mutter' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.GEMEINSAM">
          {{ 'gesuch-app.form.familiensituation.gemeinsam' | translate }}
        </mat-option>
      </mat-select>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-form-field>
  </div>

  <div class="row g-4 mt-3" *ngIf="!form.controls.obhut.disabled">
    <mat-form-field dvSharedUiFormField class="col-12 col-md-6 col-xl-4">
      <mat-label>{{
        'gesuch-app.form.familiensituation.obhut.label' | translate
      }}</mat-label>
      <mat-select formControlName="obhut">
        <mat-option [value]="null" disabled selected>
          {{ 'shared.form.select.empty' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.VATER">
          {{ 'gesuch-app.form.familiensituation.vater' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.MUTTER">
          {{ 'gesuch-app.form.familiensituation.mutter' | translate }}
        </mat-option>
        <mat-option [value]="ELTERNSCHAFTSTEILUNG.GEMEINSAM">
          {{ 'gesuch-app.form.familiensituation.gemeinsam' | translate }}
        </mat-option>
      </mat-select>

      <mat-error *dvSharedUiFormMessageError="'required'">
        {{ 'shared.form.error.required' | translate }}
      </mat-error>
    </mat-form-field>
  </div>

  <div
    *ngIf="
      !form.controls.obhutVater.disabled && !form.controls.obhutMutter.disabled
    "
    class="row g-4 mt-3"
  >
    <div class="col-12 col-md-6 col-xl-4">
      <!-- OBHUT AUFTEILUNG -->
      <dv-shared-ui-percentage-splitter
        [updateValidity]="updateValidity$ | async"
        [controlA]="form.controls.obhutMutter"
        [controlB]="form.controls.obhutVater"
      >
        <label>{{
          'gesuch-app.form.familiensituation.obhutsaufteilung.label' | translate
        }}</label>
        <span class="label-a">{{
          'gesuch-app.form.familiensituation.obhutsaufteilung.mutter'
            | translate
        }}</span>
        <span class="label-b">{{
          'gesuch-app.form.familiensituation.obhutsaufteilung.vater' | translate
        }}</span>
      </dv-shared-ui-percentage-splitter>
    </div>
  </div>

  <!-- buttons -->
  <dv-shared-ui-step-form-buttons>
    <button type="submit" class="btn btn-primary">
      {{ 'gesuch-app.form.save-and-continue' | translate }}
    </button>
  </dv-shared-ui-step-form-buttons>
</form>
