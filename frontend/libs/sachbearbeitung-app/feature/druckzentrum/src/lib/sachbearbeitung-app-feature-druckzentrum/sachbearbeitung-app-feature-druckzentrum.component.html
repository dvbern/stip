<dv-sachbearbeitung-app-pattern-overview-layout>
  <div class="container">
    <div
      class="tw-mt-2 tw-grid tw-grid-cols-1 tw-gap-6 tw-pt-6 md:tw-grid-cols-3 lg:tw-grid-cols-4 xl:tw-grid-cols-6"
      [formGroup]="quickFilterForm"
    >
      @for (quickFilter of quickFilters; track quickFilter) {
        <button
          type="button"
          (click)="quickFilterForm.controls.query.patchValue(quickFilter.typ)"
          class="btn !tw-flex tw-grow tw-items-center !tw-p-2 !tw-px-4 tw-shadow-md"
          [attr.data-testid]="'druckzentrum-quick-filter-' + quickFilter.typ"
          [class.btn-danger]="radio.checked"
          [class.btn-light]="!radio.checked"
        >
          <dv-shared-ui-icon-chip class="me-3 chip">
            <i class="icon material-symbols-rounded fs-4">{{ quickFilter.icon }}</i>
          </dv-shared-ui-icon-chip>
          <div class="flex-grow-1 tw-text-start tw-leading-4">
            <span class="fw-bold fs-7 mb-0">
              {{ 'sachbearbeitung-app.druckzentrum.quick-filter.' + quickFilter.typ | transloco }}
            </span>
            <input
              #radio
              class="fs-7 cdk-visually-hidden"
              type="radio"
              name="query"
              labelPosition="before"
              formControlName="query"
              [value]="quickFilter.typ"
              [attr.aria-label]="'sachbearbeitung-app.druckzentrum.quick-filter.' + quickFilter.typ | transloco"
            />
          </div>
        </button>
      }
    </div>
    <h1 class="tw-mb-6 tw-mt-8 tw-text-2xl" data-testid="druckzentrum-title">
      {{ 'sachbearbeitung-app.druckzentrum.title' | transloco }}
    </h1>
    <div class="tw-my-6">
      <div class="tw-dv-table tw-relative">
        <div [class.opacity-50]="druckauftragStore.cachedDruckauftragListViewSig().loading">
          <table
            mat-table
            [dvSharedUiFocusableList]="items"
            [dataSource]="druckzentrumDataSourceSig()"
            data-testid="sachbearbeitung-app.druckzentrum.table"
            mat-table
            matSort
            (matSortChange)="sortList($event)"
            tabindex="0"
          >
            <caption class="cdk-visually-hidden">
              {{
                'sachbearbeitung-app.druckzentrum.table.description' | transloco
              }}
            </caption>

            <ng-container matColumnDef="BATCH_NAME">
              <th mat-header-cell *matHeaderCellDef class="tw-w-40 tw-whitespace-nowrap">
                {{ 'sachbearbeitung-app.druckzentrum.table.batchname' | transloco }}
              </th>
              <td
                mat-cell
                *dvMatCellDef="let item; dataSource: druckzentrumDataSourceSig()"
                class="tw-w-40 tw-whitespace-nowrap"
                [dvTruncateTooltip]="item.batchName"
              >
                {{ item.batchName }}
              </td>
            </ng-container>

            <ng-container matColumnDef="BEARBEITER">
              <th mat-header-cell *matHeaderCellDef class="tw-w-40 tw-whitespace-nowrap">
                {{ 'sachbearbeitung-app.druckzentrum.table.bearbeiter' | transloco }}
              </th>
              <td
                mat-cell
                *dvMatCellDef="let item; dataSource: druckzentrumDataSourceSig()"
                class="tw-w-40 tw-whitespace-nowrap"
                [dvTruncateTooltip]="item.bearbeiter"
              >
                {{ item.bearbeiter }}
              </td>
            </ng-container>

            <ng-container matColumnDef="ERSTELLT_AM">
              <th mat-header-cell *matHeaderCellDef class="tw-w-32 tw-whitespace-nowrap">
                {{ 'sachbearbeitung-app.druckzentrum.table.timestampErstellt' | transloco }}
              </th>
              <td
                mat-cell
                *dvMatCellDef="let item; dataSource: druckzentrumDataSourceSig()"
                class="tw-w-32 tw-whitespace-nowrap"
              >
                {{ item.timestampErstellt | date: 'dd.MM.yyyy HH:mm' }}
              </td>
            </ng-container>

            <ng-container matColumnDef="STATUS">
              <th mat-header-cell *matHeaderCellDef class="tw-w-32 tw-whitespace-nowrap">
                {{ 'sachbearbeitung-app.druckzentrum.table.status' | transloco }}
              </th>
              <td
                mat-cell
                *dvMatCellDef="let item; dataSource: druckzentrumDataSourceSig()"
                class="tw-w-32 tw-whitespace-nowrap"
              >
                {{ item.druckauftragStatus }}
              </td>
            </ng-container>

            <ng-container matColumnDef="TYP">
              <th mat-header-cell *matHeaderCellDef class="tw-w-32 tw-whitespace-nowrap">
                {{ 'sachbearbeitung-app.druckzentrum.table.typ' | transloco }}
              </th>
              <td
                mat-cell
                *dvMatCellDef="let item; dataSource: druckzentrumDataSourceSig()"
                class="tw-w-32 tw-whitespace-nowrap"
              >
                {{ item.druckauftragTyp }}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr
              dvSharedUiFocusableListItem
              mat-row
              tabindex="-1"
              *dvMatRowDef="let item; dataSource: druckzentrumDataSourceSig(); columns: displayedColumns"
              class="highlightable"
            ></tr>
            <tr class="mat-mdc-row" *matNoDataRow>
              <td class="mat-mdc-cell tw-px-3" [colSpan]="displayedColumns.length">
                {{ 'shared.table.noData' | transloco }}
              </td>
            </tr>
          </table>

          <mat-paginator
            showFirstLastButtons
            [pageSizeOptions]="pageSizes"
            [pageSize]="pageSize() ?? defaultPageSize"
            [pageIndex]="page() ?? 0"
            [length]="totalEntriesSig()"
            (page)="paginate($event)"
          ></mat-paginator>
        </div>
        @if (loading()) {
          <dv-shared-ui-loading
            class="position-absolute top-50 start-50 translate-middle"
            [type]="'compact'"
          ></dv-shared-ui-loading>
        }
      </div>
    </div>
  </div>
</dv-sachbearbeitung-app-pattern-overview-layout>
