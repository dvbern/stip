@if (store.benutzers() | rdIsPendingWithoutCache) {
  <dv-shared-ui-loading></dv-shared-ui-loading>
} @else {
  @if (benutzerListDataSourceSig(); as benutzerListSource) {
    <h3 class="mt-5">{{ 'sachbearbeitung-app.admin.benutzerverwaltung.overview.title' | translate }}</h3>
    <div class="mt-4 shadow rounded-4">
      <table mat-table [dataSource]="benutzerListSource" matSort>
        <caption class="cdk-visually-hidden">
          {{
            'sachbearbeitung-app.admin.benutzervervaltung.table.description' | translate
          }}
        </caption>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ 'sachbearbeitung-app.admin.benutzervervaltung.table.name' | translate }}
          </th>
          <td mat-cell *dvMatCellDef="let benutzer; dataSource: benutzerListSource" class="fw-bold">
            {{ benutzer.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ 'sachbearbeitung-app.admin.benutzervervaltung.table.email' | translate }}
          </th>
          <td mat-cell *dvMatCellDef="let benutzer; dataSource: benutzerListSource">
            {{ benutzer.email }}
          </td>
        </ng-container>

        <ng-container matColumnDef="roles">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ 'sachbearbeitung-app.admin.benutzervervaltung.table.roles' | translate }}
          </th>
          <td mat-cell *dvMatCellDef="let benutzer; dataSource: benutzerListSource">
            <div class="d-flex gap-2">
              @for (role of benutzer.roles; track role) {
                <dv-shared-ui-badge [type]="role.color">{{ role.name }}</dv-shared-ui-badge>
              }
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="fw-bold"></tr>
        <tr
          mat-row
          dvSharedUiFocusableListItem
          tabindex="-1"
          class="highlightable"
          *matRowDef="let benutzer; columns: displayedColumns"
          [routerLink]="['.', 'edit', benutzer.id]"
        ></tr>
        <tr class="mat-mdc-row" *matNoDataRow>
          <td class="mat-mdc-cell px-3" [colSpan]="displayedColumns.length">
            {{ 'shared.table.noData' | translate }}
          </td>
        </tr>
      </table>
    </div>
  }
}
