<!-- LOADING -->
@if (viewSig().loading) {
  <dv-shared-ui-loading data-testid="form-eltern-loading"></dv-shared-ui-loading>
}

<!-- EDITOR -->
@if (editedElternteil) {
  @if (viewSig().gesuchFormular; as gesuchFormular) {
    <dv-shared-feature-gesuch-form-eltern-editor
      [elternteil]="editedElternteil"
      [changes]="viewSig().listChanges[editedElternteil.elternTyp]?.values"
      [gesuchFormular]="gesuchFormular"
      [laender]="laenderSig()"
      (saveTriggered)="handleEditorSave($event)"
      (closeTriggered)="handleEditorClose()"
      (deleteTriggered)="handleDeleteElternteil($event)"
      (formIsUnsaved)="hasUnsavedChanges = $event"
    />
  }
}

<!-- OVERVIEW -->
@if (!editedElternteil && !viewSig().loading) {
  <div class="row g-4 mt-4">
    @if (viewSig().expectVater) {
      <div class="col-12 col-md-6 col-xl-4 position-relative">
        <dv-shared-feature-gesuch-form-eltern-card
          [elternteil]="viewSig().vater"
          [elternTyp]="'VATER'"
          [translationkey]="'vater'"
          [readonly]="viewSig().readonly"
          (addTriggered)="handleAddElternteil($event)"
          (editTriggered)="handleEdit($event)"
        />
        @if (viewSig().listChanges['VATER']) {
          <dv-shared-ui-change-indicator></dv-shared-ui-change-indicator>
        }
      </div>
    }
    @if (viewSig().expectMutter) {
      <div class="col-12 col-md-6 col-xl-4 position-relative">
        <dv-shared-feature-gesuch-form-eltern-card
          [elternteil]="viewSig().mutter"
          [elternTyp]="'MUTTER'"
          [translationkey]="'mutter'"
          [readonly]="viewSig().readonly"
          (addTriggered)="handleAddElternteil($event)"
          (editTriggered)="handleEdit($event)"
        />
        @if (viewSig().listChanges['MUTTER']) {
          <dv-shared-ui-change-indicator></dv-shared-ui-change-indicator>
        }
      </div>
    }
    @if (!viewSig().expectVater && !viewSig().expectMutter) {
      <div>
        {{ 'shared.form.eltern.none' | translate }}
      </div>
    }
  </div>

  <dv-shared-ui-step-form-buttons>
    <button
      type="button"
      class="btn btn-primary"
      (click)="handleContinue()"
      [disabled]="!viewSig().gesuchId"
      data-testid="button-continue"
    >
      {{ 'shared.form.gonext' | translate }}
    </button>
  </dv-shared-ui-step-form-buttons>
}
