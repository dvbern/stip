<dv-shared-pattern-main-layout *transloco="let t">
  <div class="tw:relative tw:my-12 tw:justify-between container">
    <h1 class="tw:!mb-8">
      {{ t('shared.darlehen.title') }}
    </h1>
    <dv-shared-feature-darlehen></dv-shared-feature-darlehen>
  </div>

  <!-- MOBILE NAV -->
  <div dvHeaderMobileAddons></div>
  <div dvMobileNavContent></div>

  <!-- DESKTOP HEADER (LEFT) -->
  <div dvHeaderDesktopLeft class="tw:flex tw:grow tw:items-center tw:gap-4">
    <a
      [routerLink]="['/']"
      class="btn btn-nav fw-normal d-flex align-items-center px-2 shadow-none"
      data-testid="header-nav-dashboard"
    >
      <i class="material-symbols-rounded me-2 text-white">dashboard</i>
      <span>{{ t('shared.menu.dashboard') }}</span>
    </a>

    @let fallId = fallIdSig();
    <a
      [routerLink]="['/auszahlung', fallId]"
      class="btn btn-nav fw-normal d-flex align-items-center px-2 shadow-none"
      data-testid="header-nav-auszahlung"
      [class.disabled]="!fallId"
    >
      <i class="material-symbols-rounded me-2 text-white">account_balance_wallet</i>
      <span>{{ t('shared.menu.auszahlung') }}</span>
    </a>

    @let darlehens = darlehenStore.darlehenListViewSig();
    <button
      type="button"
      class="btn btn-nav fw-normal d-flex align-items-center px-2 shadow-none"
      data-testid="header-nav-darlehen-menu"
      [matMenuTriggerFor]="darlehenMenu"
      [class.active]="darlehenIdRouteSig()"
    >
      <i class="material-symbols-rounded me-2 text-white">account_balance</i>
      <span>{{ 'shared.header.darlehen' | transloco }}</span>
      <i class="material-symbols-rounded ms-2">expand_more</i>
    </button>
    <mat-menu #darlehenMenu="matMenu" class="header-menu-panel mt-2 rounded">
      <div class="d-flex flex-column gap-2">
        @for (darlehen of darlehens.darlehenList; track $index) {
          <a
            [routerLink]="['/', 'darlehen', darlehen.id]"
            class="btn btn-nav fw-normal d-flex align-items-center px-3 shadow-none"
            data-testid="header-nav-darlehen-menu-item"
            [class.active]="darlehenIdRouteSig() === darlehen.id"
          >
            <span>
              {{
                'shared.header.darlehen.item'
                  | transloco
                    : {
                        date: darlehen.timestampErstellt | date: 'dd.MM.yyyy',
                      }
              }}
            </span>
          </a>
        }
        <!-- button create darlehen -->
        @if (canCreateDarlehenSig() && fallId) {
          <button
            type="button"
            class="btn btn-outline-primary"
            data-testid="cockpit-gesuch-darlehen-create"
            (click)="darlehenStore.createDarlehen$({ fallId })"
          >
            {{ 'shared.dashboard.darlehen.create' | transloco }}
          </button>
        }
      </div>
    </mat-menu>
  </div>

  <!-- DESKTOP HEADER (RIGHT) -->
  <div dvHeaderDesktopRight class="d-flex align-items-center gap-4"></div>
</dv-shared-pattern-main-layout>
